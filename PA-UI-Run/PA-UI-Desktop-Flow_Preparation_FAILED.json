FUNCTION Preparation GLOBAL
    # Öffne Browser
    WebAutomation.LaunchFirefox.LaunchFirefox Url: $'''https://www.google.com/''' WindowState: WebAutomation.BrowserWindowState.Normal ClearCache: False ClearCookies: False WaitForPageToLoadTimeout: 60 Timeout: 60 PiPUserDataFolderMode: WebAutomation.PiPUserDataFolderModeEnum.AutomaticProfile TargetDesktop: $'''{\"DisplayName\":\"Lokaler Computer\",\"Route\":{\"ServerType\":\"Local\",\"ServerAddress\":\"\"},\"DesktopType\":\"local\"}''' BrowserInstance=> Browser
    # Öffne Städte-Liste > Kopiere Städte aus Städte-Liste > Schließe Städte-Liste
    System.RunApplication.RunApplicationAndWaitToLoad ApplicationPath: StaedtePath WindowStyle: System.ProcessWindowStyle.Normal Timeout: 0 ProcessId=> AppProcessId
    WAIT (UIAutomation.WaitForWindowContent.WindowToContainElement Element: appmask['Window \'staedte - Excel\''])
    UIAutomation.FocusWindow.Focus Window: appmask['Window \'staedte - Excel\'']
    MouseAndKeyboard.SendKeys.FocusAndSendKeysByControl Control: appmask['Window \'staedte - Excel\''] TextToSend: $'''{Control}({G})A2{Enter}''' DelayBetweenKeystrokes: 300 SendTextAsHardwareKeys: False
    MouseAndKeyboard.SendKeys.FocusAndSendKeysByControl Control: appmask['Window \'staedte - Excel\''] TextToSend: $'''{Control}({Shift}({Down}))''' DelayBetweenKeystrokes: 10 SendTextAsHardwareKeys: False
    MouseAndKeyboard.SendKeys.FocusAndSendKeysByControl Control: appmask['Window \'staedte - Excel\''] TextToSend: $'''{Control}({C})''' DelayBetweenKeystrokes: 10 SendTextAsHardwareKeys: False
    MouseAndKeyboard.SendKeys.FocusAndSendKeysByControl Control: appmask['Window \'staedte - Excel\''] TextToSend: $'''{Alt}({F4})''' DelayBetweenKeystrokes: 10 SendTextAsHardwareKeys: False
    # Öffne Wetter-Ergebnisse
    System.RunApplication.RunApplicationAndWaitToLoad ApplicationPath: WeatherPath WindowStyle: System.ProcessWindowStyle.Normal Timeout: 0 ProcessId=> AppProcessId2
    WAIT (UIAutomation.WaitForWindowContent.WindowToContainElement Element: appmask['Window \'wetter_ergebnisse_man1 - Excel\''])
    UIAutomation.FocusWindow.Focus Window: appmask['Window \'wetter_ergebnisse_man1 - Excel\'']
    WAIT (UIAutomation.WaitForWindow.ToBecomeFocused Window: appmask['Window \'wetter_ergebnisse_man1 - Excel\''])
    # Fenster anordnen
    MouseAndKeyboard.SendKeys.FocusAndSendKeysByControl Control: appmask['Window \'wetter_ergebnisse_man1 - Excel\''] TextToSend: $'''{LWin}({Right}){Escape}''' DelayBetweenKeystrokes: 300 SendTextAsHardwareKeys: False
    # Städte in Tabelle einfügen
    MouseAndKeyboard.SendKeys.FocusAndSendKeysByControl Control: appmask['Window \'wetter_ergebnisse_man1 - Excel\''] TextToSend: $'''{Control}({G})C3{Enter}''' DelayBetweenKeystrokes: 300 SendTextAsHardwareKeys: False
    MouseAndKeyboard.SendKeys.FocusAndSendKeysByControl Control: appmask['Window \'wetter_ergebnisse_man1 - Excel\''] TextToSend: $'''{Shift}({F10}){T}{Enter}''' DelayBetweenKeystrokes: 300 SendTextAsHardwareKeys: False
END FUNCTION

# [ControlRepository][PowerAutomateDesktop]

{
  "ControlRepositorySymbols": [
    {
      "IgnoreImagesOnSerialization": false,
      "Repository": "{\r\n  \"Screens\": [\r\n    {\r\n      \"Controls\": [],\r\n      \"Handle\": {\r\n        \"value\": 0\r\n      },\r\n      \"ProcessName\": null,\r\n      \"ScreenShot\": null,\r\n      \"ElementTypeName\": \"Window\",\r\n      \"InstanceId\": \"7b10bc7a-464c-4c43-966b-633b9537a42f\",\r\n      \"Name\": \"Window 'staedte - Excel'\",\r\n      \"SelectorCount\": 1,\r\n      \"Selectors\": [\r\n        {\r\n          \"CustomSelector\": null,\r\n          \"Elements\": [\r\n            {\r\n              \"Attributes\": [\r\n                {\r\n                  \"Ignore\": true,\r\n                  \"IsOrdinal\": false,\r\n                  \"IsDisabledAttribute\": false,\r\n                  \"Name\": \"Class\",\r\n                  \"Operation\": \"EqualTo\",\r\n                  \"Value\": \"XLMAIN\"\r\n                },\r\n                {\r\n                  \"Ignore\": true,\r\n                  \"IsOrdinal\": false,\r\n                  \"IsDisabledAttribute\": false,\r\n                  \"Name\": \"Enabled\",\r\n                  \"Operation\": \"EqualTo\",\r\n                  \"Value\": true\r\n                },\r\n                {\r\n                  \"Ignore\": true,\r\n                  \"IsOrdinal\": false,\r\n                  \"IsDisabledAttribute\": false,\r\n                  \"Name\": \"Id\",\r\n                  \"Operation\": \"EqualTo\",\r\n                  \"Value\": \"\"\r\n                },\r\n                {\r\n                  \"Ignore\": false,\r\n                  \"IsOrdinal\": false,\r\n                  \"IsDisabledAttribute\": false,\r\n                  \"Name\": \"Name\",\r\n                  \"Operation\": \"RegexMatch\",\r\n                  \"Value\": \"^staedte(.*) - Excel$\"\r\n                },\r\n                {\r\n                  \"Ignore\": true,\r\n                  \"IsOrdinal\": true,\r\n                  \"IsDisabledAttribute\": false,\r\n                  \"Name\": \"Ordinal\",\r\n                  \"Operation\": \"EqualTo\",\r\n                  \"Value\": 0\r\n                },\r\n                {\r\n                  \"Ignore\": false,\r\n                  \"IsOrdinal\": false,\r\n                  \"IsDisabledAttribute\": false,\r\n                  \"Name\": \"Process\",\r\n                  \"Operation\": \"EqualTo\",\r\n                  \"Value\": \"EXCEL\"\r\n                },\r\n                {\r\n                  \"Ignore\": true,\r\n                  \"IsOrdinal\": false,\r\n                  \"IsDisabledAttribute\": false,\r\n                  \"Name\": \"Visible\",\r\n                  \"Operation\": \"EqualTo\",\r\n                  \"Value\": true\r\n                }\r\n              ],\r\n              \"CustomValue\": null,\r\n              \"Ignore\": false,\r\n              \"Name\": \"Window 'staedte.xlsx - Excel'\",\r\n              \"Tag\": \"window\"\r\n            }\r\n          ],\r\n          \"Ignore\": false,\r\n          \"ImageSelector\": null,\r\n          \"IsCustom\": false,\r\n          \"IsImageBased\": false,\r\n          \"IsPlaceholderSelector\": false,\r\n          \"IsWindowsInstance\": false,\r\n          \"Name\": \"Default Selector\",\r\n          \"Properties\": []\r\n        }\r\n      ],\r\n      \"Tag\": \"window\",\r\n      \"ScreenshotPath\": \"controlRepo-screenshots\\\\7f190bc5-d03d-4174-a0cf-cb0265966a48.png\"\r\n    },\r\n    {\r\n      \"Controls\": [],\r\n      \"Handle\": {\r\n        \"value\": 0\r\n      },\r\n      \"ProcessName\": null,\r\n      \"ScreenShot\": null,\r\n      \"ElementTypeName\": \"Window\",\r\n      \"InstanceId\": \"37d51994-5f55-4072-86d4-10609d98b77c\",\r\n      \"Name\": \"Window 'wetter_ergebnisse_man1 - Excel'\",\r\n      \"SelectorCount\": 1,\r\n      \"Selectors\": [\r\n        {\r\n          \"CustomSelector\": null,\r\n          \"Elements\": [\r\n            {\r\n              \"Attributes\": [\r\n                {\r\n                  \"Ignore\": true,\r\n                  \"IsOrdinal\": false,\r\n                  \"IsDisabledAttribute\": false,\r\n                  \"Name\": \"Class\",\r\n                  \"Operation\": \"EqualTo\",\r\n                  \"Value\": \"XLMAIN\"\r\n                },\r\n                {\r\n                  \"Ignore\": true,\r\n                  \"IsOrdinal\": false,\r\n                  \"IsDisabledAttribute\": false,\r\n                  \"Name\": \"Enabled\",\r\n                  \"Operation\": \"EqualTo\",\r\n                  \"Value\": true\r\n                },\r\n                {\r\n                  \"Ignore\": true,\r\n                  \"IsOrdinal\": false,\r\n                  \"IsDisabledAttribute\": false,\r\n                  \"Name\": \"Id\",\r\n                  \"Operation\": \"EqualTo\",\r\n                  \"Value\": \"\"\r\n                },\r\n                {\r\n                  \"Ignore\": false,\r\n                  \"IsOrdinal\": false,\r\n                  \"IsDisabledAttribute\": false,\r\n                  \"Name\": \"Name\",\r\n                  \"Operation\": \"EqualTo\",\r\n                  \"Value\": \"wetter_ergebnisse_man1 - Excel\"\r\n                },\r\n                {\r\n                  \"Ignore\": true,\r\n                  \"IsOrdinal\": true,\r\n                  \"IsDisabledAttribute\": false,\r\n                  \"Name\": \"Ordinal\",\r\n                  \"Operation\": \"EqualTo\",\r\n                  \"Value\": 0\r\n                },\r\n                {\r\n                  \"Ignore\": false,\r\n                  \"IsOrdinal\": false,\r\n                  \"IsDisabledAttribute\": false,\r\n                  \"Name\": \"Process\",\r\n                  \"Operation\": \"EqualTo\",\r\n                  \"Value\": \"EXCEL\"\r\n                },\r\n                {\r\n                  \"Ignore\": true,\r\n                  \"IsOrdinal\": false,\r\n                  \"IsDisabledAttribute\": false,\r\n                  \"Name\": \"Visible\",\r\n                  \"Operation\": \"EqualTo\",\r\n                  \"Value\": true\r\n                }\r\n              ],\r\n              \"CustomValue\": null,\r\n              \"Ignore\": false,\r\n              \"Name\": \"Window 'wetter_ergebnisse_man1 - Excel'\",\r\n              \"Tag\": \"window\"\r\n            }\r\n          ],\r\n          \"Ignore\": false,\r\n          \"ImageSelector\": null,\r\n          \"IsCustom\": false,\r\n          \"IsImageBased\": false,\r\n          \"IsPlaceholderSelector\": false,\r\n          \"IsWindowsInstance\": false,\r\n          \"Name\": \"Default Selector\",\r\n          \"Properties\": []\r\n        }\r\n      ],\r\n      \"Tag\": \"window\",\r\n      \"ScreenshotPath\": \"controlRepo-screenshots\\\\05365855-d364-4ec4-9f9d-b400e3010ffc.png\"\r\n    }\r\n  ],\r\n  \"Version\": 1\r\n}",
      "ImportMetadata": {
        "DisplayName": "Lokaler Computer",
        "ConnectionString": "",
        "Type": "Local",
        "DesktopType": "local"
      },
      "Name": "appmask"
    }
  ],
  "ImageRepositorySymbol": {
    "Repository": "{\r\n  \"Folders\": [],\r\n  \"Images\": [],\r\n  \"Version\": 1\r\n}",
    "ImportMetadata": {},
    "Name": "imgrepo"
  },
  "ConnectionReferences": []
}